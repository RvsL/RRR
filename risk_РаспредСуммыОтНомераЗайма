library(dplyr)
library(sqldf)

options(sqldf.RPostgreSQL.user ="postgres",
sqldf.RPostgreSQL.password ="postgress",
sqldf.RPostgreSQL.dbname ="risk",
sqldf.RPostgreSQL.host ="192.168.100.21",
sqldf.RPostgreSQL.port =5432)
 
stats <- sqldf("select ЗаймПоСчету,ЗапрашиваемаяСумма,ВыданнаяСумма from ДанныеЗаявок where ВыданнаяСумма > 0", drv="PostgreSQL")
glimpse(stats)
> t <- head(stats,10) %>% mutate(cat = as.integer(cut(ВыданнаяСумма, breaks = c(3000,6000,9000,12000,15000,18000,20000))))
